# 微机接口实验 - 8259 可编程中断控制器应用

## 实验列表

| **实验编号** | **文件名**   | **实验名称**       | **核心功能**                                     |
| ------------ | ------------ | ------------------ | ------------------------------------------------ |
| **Exp 1**    | `A82591.ASM` | **单级中断控制**   | 使用主片 IRQ7，触发中断后屏幕显示字符 '7'        |
| **Exp 2**    | `A82592.ASM` | **中断优先级嵌套** | 使用主片 IRQ6 和 IRQ7，验证 IRQ6 优先级高于 IRQ7 |
| **Exp 3**    | `A82593.ASM` | **双片级联中断**   | 主片 IRQ7 与从片 IRQ1 协同工作，验证级联方式     |

------

## 实验详情

### 实验一：单级中断控制 (A82591.ASM)

1. 实验目的

掌握 8259 的基本初始化流程（ICW1~ICW4）和中断向量表的修改方法。验证外部中断请求的处理过程

**2. 原理分析**

- **中断源**: 单次脉冲连接至主片 **IRQ7**
- **向量设置**:
  - 主片中断类型号基址设置为 `08H`
  - IRQ7 对应的中断号为 `0FH`，向量地址为 `003CH`
- **控制字**:
  - `ICW1`: 边沿触发，单片模式
  - `OCW1`: 解除 IRQ7 的屏蔽（允许中断）
- **执行流程**: 当 IRQ7 接收到上升沿信号，CPU 暂停主程序，跳转至中断服务程序，在屏幕打印字符 `'7'`，然后发送中断结束命令 (EOI) 并返回

------

### 实验二：中断优先级应用 (A82592.ASM)

1. 实验目的

验证 8259 的固定优先级机制（IRQ0 > IRQ1 > ... > IRQ7）。在本实验中，IRQ6 的优先级高于 IRQ7

**2. 原理分析**

- **中断源**: 两个脉冲源分别接 **IRQ6** 和 **IRQ7**
- **优先级演示**:
  - 如果在处理 IRQ7 中断（打印 'M'）的过程中，IRQ6 信号到来，CPU 应该**响应并嵌套**执行 IRQ6 的服务程序（打印 'S' 和 '6'），处理完后再回到 IRQ7 继续执行（打印 '7'）
  - 反之，如果在处理 IRQ6 时 IRQ7 到来，CPU **不会响应** IRQ7，直到 IRQ6 结束
- **中断服务**:
  - `MIR7` (IRQ7): 显示 'M' -> 延时 -> 显示 '7'
  - `MIR6` (IRQ6): 显示 'S' -> 显示 '6'

------

### 实验三：双片级联中断 (A82593.ASM)

1. 实验目的

掌握两片 8259 级联的初始化方法，理解主片与从片的连接关系（Master IR2 <-> Slave INT）

**2. 原理分析**

- **级联结构**: 从片的 INT 引脚连接到主片的 **IR2** 引脚
- **中断源**:
  - 源 1: 主片 **IRQ7**
  - 源 2: 从片 **IRQ1**
- **初始化配置**:
  - **主片**: `ICW3 = 04H` (表示 IR2 接有从片)
  - **从片**: `ICW3 = 02H` (表示自己连接在主片的 IR2 上)。中断基址设为 `30H`
- **EOI 处理**:
  - 主片中断（IRQ7）：只需向主片发送 EOI
  - 从片中断（IRQ1）：必须向**从片和主片同时**发送 EOI，否则后续中断无法响应