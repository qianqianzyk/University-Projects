# 微机接口实验 - 8254 可编程定时/计数器应用

## 实验列表

| **实验编号** | **文件名**   | **实验名称**             | **核心功能**                                            |
| ------------ | ------------ | ------------------------ | ------------------------------------------------------- |
| **Exp 1**    | `A82541.ASM` | **事件计数与中断控制**   | 计数器模式 0，每检测到 5 个脉冲触发一次中断并输出字符   |
| **Exp 2**    | `A82542.ASM` | **级联定时与方波发生器** | 计数器模式 3，双计数器级联，将 1MHz 时钟分频为 1Hz 方波 |

------

## 实验详情

### 实验一：事件计数与中断控制 (A82541.ASM)

1. 实验目的

利用 8254 的计数功能对外部事件（如按键脉冲）进行计数。当计数满后，通过硬件中断（IRQ7）请求 CPU 服务，在屏幕上显示提示字符。

**2. 原理分析**

- **工作模式**: 计数器 0 工作在 **方式 0** (计数结束中断)
- **计数初值**: 设置为 `4`
- **中断机制**:
  - 每当 CLK0 引脚接收到 5 个脉冲（从 4 减到 0），OUT0 引脚输出高电平跳变
  - 该跳变信号连接到 8259 主片的 IRQ7 引脚，触发中断
- **中断服务**: 中断程序向屏幕输出字符 `'M'`，并重新装载计数初值，以便进行下一轮计数

------

### 实验二：级联定时与方波发生器 (A82542.ASM)

1. 实验目的

掌握 8254 的长定时方法。由于 16 位计数器的最大计数植为 65536，无法直接将 1MHz 分频为 1Hz（需要 1,000,000 分频），因此需要使用两个计数器进行级联

**2. 原理分析**

- **输入时钟**: 1 MHz (10^6 Hz)
- **目标频率**: 1 Hz (周期 1s)
- **分频方案**:
  - **第一级 (Counter 0)**: 将 1MHz 进行 1000 分频，输出 1kHz
    - 模式: 方式 3 (方波发生器)
    - 初值: 1000 (`03E8H`)
  - **第二级 (Counter 1)**: 将 1kHz 进行 1000 分频，输出 1Hz
    - 模式: 方式 3 (方波发生器)
    - 初值: 1000 (`03E8H`)